function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var i=[],s=!0,n=!1,c=void 0;try{for(var a,r=e[Symbol.iterator]();!(s=(a=r.next()).done)&&(i.push(a.value),!t||i.length!==t);s=!0);}catch(o){n=!0,c=o}finally{try{s||null==r.return||r.return()}finally{if(n)throw c}}return i}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"2Jat":function(e,t,i){"use strict";i.r(t);var s=i("ofXK"),n=i("kt0X"),c={primaryIssueKey:"",primaryIssue:null,selectedIssueKey:"",selectedIssue:null,timelineView:null,isSelectedIssueViewCompact:!1,hierarchicalIssue:null,purpose:[],recentlyViewedItems:[],recentmostItem:null,updatedField:null},a=i("j9Al"),r={LoadPrimaryIssue:Object(a.c)("[LoadPrimaryIssue]"),LoadPrimaryIssueFailed:Object(a.c)("[LoadPrimaryIssue] Failed"),LoadPrimaryIssueSuccess:Object(a.c)("[LoadPrimaryIssue] Success"),LoadPrimaryIssueEpicChildren:Object(a.c)("[LoadPrimaryIssueEpicChildren]"),LoadPrimaryIssueEpicChildrenFailed:Object(a.c)("[LoadPrimaryIssueEpicChildren] Failed"),LoadPrimaryIssueEpicChildrenSuccess:Object(a.c)("[LoadPrimaryIssueEpicChildren] Success"),LoadPrimaryIssueRelatedLinks:Object(a.c)("[LoadPrimaryIssueRelatedLinks]"),LoadPrimaryIssueRelatedLinksFailed:Object(a.c)("[LoadPrimaryIssueRelatedLinks] Failed"),LoadPrimaryIssueRelatedLinksSuccess:Object(a.c)("[LoadPrimaryIssueRelatedLinks] Success"),SetHierarchicalIssue:Object(a.c)("[SetHierarchicalIssue]"),LoadProjectDetails:Object(a.c)("[LoadProjectDetails]"),LoadProjectDetailsFailed:Object(a.c)("[LoadProjectDetails] Failed"),LoadProjectDetailsSuccess:Object(a.c)("[LoadProjectDetails] Success"),LoadSelectedIssue:Object(a.c)("[LoadSelectedIssue]"),LoadSelectedIssueFailed:Object(a.c)("[LoadSelectedIssue] Failed"),LoadSelectedIssueSuccess:Object(a.c)("[LoadSelectedIssue] Success"),ChangeSelectedIssueView:Object(a.c)("[ChangeSelectedIssueView]"),LoadSelectedIssueEpicChildren:Object(a.c)("[LoadSelectedIssueEpicChildren]"),LoadSelectedIssueEpicChildrenFailed:Object(a.c)("[LoadSelectedIssueEpicChildren] Failed"),LoadSelectedIssueEpicChildrenSuccess:Object(a.c)("[LoadSelectedIssueEpicChildren] Success"),LoadSelectedIssueRelatedLinks:Object(a.c)("[LoadSelectedIssueRelatedLinks]"),LoadSelectedIssueRelatedLinksFailed:Object(a.c)("[LoadSelectedIssueRelatedLinks] Failed"),LoadSelectedIssueRelatedLinksSuccess:Object(a.c)("[LoadSelectedIssueRelatedLinks] Success"),SetSelectedIssue:Object(a.c)("[SetSelectedIssue]"),PopulateIssueTimelineView:Object(a.c)("[PopulateIssueTimelineView]"),SetPurpose:Object(a.c)("[SetPurpose]"),UpdateOrganizationPurpose:Object(a.c)("[UpdateOrganizationPurpose]"),SetRecentlyViewed:Object(a.c)("[SetRecentlyViewed]"),UpdateFieldValue:Object(a.c)("[UpdateFieldValue]"),UpdateFieldValueFailed:Object(a.c)("[UpdateFieldValue] Failed"),UpdateFieldValueSuccess:Object(a.c)("[UpdateFieldValue] Success"),UpdateOrganizationTitle:Object(a.c)("[UpdateOrganizationTitle]"),UpdateOrganizationTitleFailed:Object(a.c)("[UpdateOrganizationTitle] Failed"),UpdateOrganizationTitleSuccess:Object(a.c)("[UpdateOrganizationTitle] Success")},o=function e(t){_classCallCheck(this,e),this.payload=t,this.type=r.LoadPrimaryIssue},l=function e(t){_classCallCheck(this,e),this.payload=t,this.type=r.LoadPrimaryIssueEpicChildren},u=function e(t){_classCallCheck(this,e),this.payload=t,this.type=r.LoadPrimaryIssueRelatedLinks},d=function e(t){_classCallCheck(this,e),this.payload=t,this.type=r.SetHierarchicalIssue},b=function e(t){_classCallCheck(this,e),this.payload=t,this.type=r.LoadProjectDetails},p=function e(t){_classCallCheck(this,e),this.payload=t,this.type=r.LoadSelectedIssue},h=function e(t){_classCallCheck(this,e),this.payload=t,this.type=r.ChangeSelectedIssueView},f=function e(t){_classCallCheck(this,e),this.payload=t,this.type=r.LoadSelectedIssueEpicChildren},g=function e(t){_classCallCheck(this,e),this.payload=t,this.type=r.LoadSelectedIssueRelatedLinks},y=function e(t){_classCallCheck(this,e),this.payload=t,this.type=r.SetSelectedIssue},m=function e(t){_classCallCheck(this,e),this.payload=t,this.type=r.PopulateIssueTimelineView},I=function e(t){_classCallCheck(this,e),this.payload=t,this.type=r.SetPurpose},v=function e(t){_classCallCheck(this,e),this.payload=t,this.type=r.UpdateOrganizationPurpose},k=function e(t){_classCallCheck(this,e),this.payload=t,this.type=r.UpdateFieldValue},C=i("krUz"),O=i("iPf6"),j=i("LvDl");function L(e,t){switch(t.type){case r.LoadPrimaryIssue:return Object.assign(Object.assign({},e),{primaryIssue:null,primaryIssueKey:t.payload.issue});case r.LoadPrimaryIssueSuccess:return Object.assign(Object.assign({},e),{primaryIssue:S(t.payload)});case r.LoadPrimaryIssueEpicChildren:return Object.assign(Object.assign({},e),{primaryIssue:Object.assign(Object.assign({},e.primaryIssue),{epicChildrenLoading:!0,epicChildrenLoaded:!1})});case r.LoadPrimaryIssueEpicChildrenSuccess:var i=j.map(t.payload.issues,(function(e){return C.u(e)}));return Object.assign(Object.assign({},e),{primaryIssue:Object.assign(Object.assign({},e.primaryIssue),{epicChildrenLoading:!1,epicChildrenLoaded:!0,epicChildren:i})});case r.LoadPrimaryIssueRelatedLinks:return Object.assign(Object.assign({},e),{primaryIssue:Object.assign(Object.assign({},e.primaryIssue),{relatedLinksLoading:!0})});case r.LoadPrimaryIssueRelatedLinksSuccess:var s=function(e,t){if(!e.primaryIssue)return null;var i=e.primaryIssue.relatedLinks;if(t.payload&&t.payload.issues&&i){var s=j.map(t.payload.issues,(function(e){return j.pick(C.u(e),C.w)}));i.forEach((function(e){var t=j.find(s,{key:e.key});t&&(e.created=t.created,e.duedate=t.duedate,e.updated=t.updated,e.resolution=t.resolution,e.project=t.project,e.labels=t.labels,e.fixVersions=t.fixVersions,e.components=t.components)}))}return i}(e,t);return Object.assign(Object.assign({},e),{primaryIssue:Object.assign(Object.assign({},e.primaryIssue),{relatedLinksLoading:!1,relatedLinksLoaded:!0,relatedLinks:s})});case r.SetHierarchicalIssue:return Object.assign(Object.assign({},e),{hierarchicalIssue:t.payload});case r.LoadProjectDetails:return Object.assign(Object.assign({},e),{primaryIssue:Object.assign(Object.assign({},e.primaryIssue),{projectConfigLoading:!0})});case r.LoadProjectDetailsSuccess:var n=(g=t.payload,(y=j.pick(g,["id","key","description","name","customFields","startdate"])).hierarchy=[],y.storyboardFields=[],g.issueTypes&&(y.standardIssueTypes=V(g.issueTypes,!1),y.subTaskIssueTypes=V(g.issueTypes,!0)),y.metadata={},g.components&&(y.metadata.components=j.sortBy(j.map(g.components,(function(e){return j.pick(e,["id","name","description"])})),["name"])),g.versions&&(y.metadata.versions=j.sortBy(j.map(g.versions,(function(e){return j.pick(e,["archived","id","name","releaseDate","description"])})),["name"])),y);return Object.assign(Object.assign({},e),{primaryIssue:Object.assign(Object.assign({},e.primaryIssue),{projectConfigLoading:!1,projectConfigLoaded:!0,projectConfig:n})});case r.LoadSelectedIssue:return Object.assign(Object.assign({},e),{selectedIssue:null,selectedIssueKey:t.payload.issue});case r.LoadSelectedIssueSuccess:return Object.assign(Object.assign({},e),{selectedIssue:S(t.payload)});case r.PopulateIssueTimelineView:var c=e.selectedIssue.projectConfig.startdate.id||"created",a=O.a(t.payload,c),o=O.b(t.payload,a.timespan,c,!1);return Object.assign(Object.assign({},e),{timelineView:{metadata:a,records:o}});case r.ChangeSelectedIssueView:return Object.assign(Object.assign({},e),{isSelectedIssueViewCompact:t.payload});case r.LoadSelectedIssueEpicChildren:return Object.assign(Object.assign({},e),{selectedIssue:Object.assign(Object.assign({},e.selectedIssue),{epicChildrenLoading:!0,epicChildrenLoaded:!1})});case r.LoadSelectedIssueEpicChildrenSuccess:var l=j.map(t.payload.issues,(function(e){return C.u(e)}));return Object.assign(Object.assign({},e),{selectedIssue:Object.assign(Object.assign({},e.selectedIssue),{epicChildrenLoading:!1,epicChildrenLoaded:!0,epicChildren:l})});case r.LoadSelectedIssueRelatedLinks:return Object.assign(Object.assign({},e),{selectedIssue:Object.assign(Object.assign({},e.selectedIssue),{relatedLinksLoading:!0,relatedLinksLoaded:!1})});case r.LoadSelectedIssueRelatedLinksSuccess:var u=j.map(t.payload.issues,(function(e){return C.u(e)})),d=e.selectedIssue.relatedLinks;return u.forEach((function(e){var t=j.find(d,{key:e.key});e.linkType=t?t.linkType:"link"})),Object.assign(Object.assign({},e),{selectedIssue:Object.assign(Object.assign({},e.selectedIssue),{relatedLinksLoading:!1,relatedLinksLoaded:!0,relatedLinks:u})});case r.SetSelectedIssue:return Object.assign(Object.assign({},e),{selectedIssue:t.payload});case r.SetPurpose:return Object.assign(Object.assign({},e),{purpose:t.payload});case r.UpdateOrganizationPurpose:var b=t.payload||{},p=e.hierarchicalIssue,h=C.x(p,C.a.Organization);return h&&(h.label=b.name,h.title=b.name,h.description=b.purpose),Object.assign(Object.assign({},e),{hierarchicalIssue:p,purpose:e.purpose.map((function(e){return e.issueType===C.a.Organization?Object.assign(Object.assign({},e),{key:b.name,label:b.name,title:b.name,purpose:b.purpose}):e}))});case r.SetRecentlyViewed:return Object.assign(Object.assign({},e),{recentmostItem:t.payload});case r.UpdateFieldValue:return Object.assign(Object.assign({},e),{updatedField:null});case r.UpdateFieldValueSuccess:var f=t.payload;return Object.assign(Object.assign({},e),{updatedField:f});case r.UpdateOrganizationTitleSuccess:return Object.assign(Object.assign({},e),{primaryIssue:Object.assign(Object.assign({},e.primaryIssue),{organization:t.payload})});default:return e}var g,y}function S(e){var t=e.extendedFields;e.projectConfig&&e.projectConfig.startdate&&j.remove(t,e.projectConfig.startdate);var i=C.v(e.issue,t);return i&&(i.organization=e.organization,i.projectConfig=e.projectConfig,i.projectConfigLoaded=!!e.projectConfig,i.relatedLinks=C.r(e.issue),i.epicChildrenLoading=!1,i.epicChildrenLoaded=!1,i.relatedLinksLoading=!1,i.relatedLinksLoaded=!1),i}function V(e,t){return j.map(j.filter(e,{subtask:t}),(function(e){return{name:e.name,list:[]}}))}var w=i("fXoL"),W=i("itXk"),P=i("pLZG"),F=i("cdP3"),R=i("6NWb"),q=i("tyNb"),x=i("g9iH"),z=i("7zfz"),E=function(e,t){return{"small text-muted text-uppercase font-italic":e,"font-weight-bold":t}};function $(e,t){if(1&e&&(w.Wb(0,"div",6),w.Oc(1),w.Vb()),2&e){var i=t.$implicit,s=w.kc(2);w.qc("ngClass",w.vc(3,E,s.checkIfCustomNode(i),i.key===s.issueKey))("title",s.getIssueTitle(i)),w.Cb(1),w.Qc(" ",i.label,"")}}function T(e,t){if(1&e&&(w.Wb(0,"div",7),w.Oc(1),w.Vb()),2&e){var i=t.$implicit,s=w.kc(2);w.qc("title",s.getHeaderTitle(i)),w.Cb(1),w.Qc(" ",i.label," ")}}function M(e,t){1&e&&w.Rb(0,"fa-icon",10)}function _(e,t){if(1&e&&(w.Wb(0,"i",8),w.Oc(1),w.Mc(2,M,1,0,"fa-icon",9),w.Vb()),2&e){var i=t.$implicit;w.Cb(1),w.Qc(" ",i.label," "),w.Cb(1),w.qc("ngIf",i.editable)}}var N=function(e){return[e]};function D(e,t){if(1&e){var i=w.Xb();w.Wb(0,"div",1),w.Wb(1,"p-tree",2),w.ic("selectionChange",(function(e){return w.Fc(i),w.kc().selectedNode=e}))("onNodeSelect",(function(e){return w.Fc(i),w.kc().nodeSelected(e)})),w.Mc(2,$,2,6,"ng-template",3),w.Mc(3,T,2,2,"ng-template",4),w.Mc(4,_,3,2,"ng-template",5),w.Vb(),w.Vb()}if(2&e){var s=w.kc();w.Cb(1),w.qc("value",w.uc(2,N,s.rootNode))("selection",s.selectedNode)}}var U,A=((U=function(){function e(t,i){_classCallCheck(this,e),this.router=t,this.activatedRoute=i,this.getIssueTitle=function(e){return Object(C.t)(e)?e.title:"[".concat(e.issueType,"] ").concat(e.linkType||""," ").concat(e.key," | ").concat(e.title)},this.getHeaderTitle=function(e){return"[".concat(e.issueType,"] ").concat(e.title)},this.checkIfCustomNode=function(e){return Object(C.t)(e)}}return _createClass(e,[{key:"nodeSelected",value:function(e){if(e.node.editable)e.node.memento={type:e.node.type,selectable:e.node.selectable},e.node.type=C.b.Editing,e.node.selectable=!1;else{var t=(i=this.router,(s=i.parseUrl(i.url)).root.children[q.c]&&s.root.children[q.c].segments&&5===s.root.children[q.c].segments.length?j.last(s.root.children[q.c].segments).path:"details");this.router.navigate(["../..",e.node.key,t],{relativeTo:this.activatedRoute})}var i,s}}]),e}()).\u0275fac=function(e){return new(e||U)(w.Qb(q.d),w.Qb(q.a))},U.\u0275cmp=w.Kb({type:U,selectors:[["app-issue-treeview"]],inputs:{issueKey:"issueKey",rootNode:"rootNode"},decls:1,vars:1,consts:[["class","pb-5",4,"ngIf"],[1,"pb-5"],["selectionMode","single",3,"value","selection","selectionChange","onNodeSelect"],["pTemplate","default"],["pTemplate","Heading"],["pTemplate","Editable"],[2,"font-size","90%",3,"ngClass","title"],[3,"title"],[1,"editable-node"],["size","sm","class","text-muted ml-1","icon","pencil-alt",4,"ngIf"],["size","sm","icon","pencil-alt",1,"text-muted","ml-1"]],template:function(e,t){1&e&&w.Mc(0,D,5,4,"div",0),2&e&&w.qc("ngIf",t.rootNode)},directives:[s.n,x.a,z.d,s.l,R.a],encapsulation:2}),U),K=i("l2bN");function Q(e,t){if(1&e&&(w.Wb(0,"div"),w.Rb(1,"app-issue-treeview",15),w.Vb()),2&e){var i=w.kc(2);w.Cb(1),w.qc("rootNode",i.hierarchicalNode)("issueKey",i.selectedIssueKey)}}function H(e,t){if(1&e&&(w.Wb(0,"div",20),w.Wb(1,"h5",21),w.Oc(2),w.Vb(),w.Rb(3,"ngx-md",22),w.Vb()),2&e){var i=w.kc().$implicit;w.Cb(2),w.Qc(" ",i.title," "),w.Cb(1),w.qc("data",i.purpose)}}var X=function(e){return{"float-left":e}};function B(e,t){if(1&e&&(w.Wb(0,"div",16),w.Rb(1,"div",9),w.Wb(2,"div",17),w.Wb(3,"a",6),w.ic("click",(function(){var e=t.$implicit;return e.show=!e.show})),w.Rb(4,"fa-icon",7),w.Wb(5,"span",18),w.Oc(6),w.Vb(),w.Vb(),w.Vb(),w.Mc(7,H,4,2,"div",19),w.Vb()),2&e){var i=t.$implicit;w.qc("ngClass",w.uc(4,X,!i.show)),w.Cb(4),w.qc("icon",i.show?"chevron-down":"chevron-right"),w.Cb(2),w.Qc("",i.issueType," purpose"),w.Cb(1),w.qc("ngIf",i.show)}}function J(e,t){if(1&e){var i=w.Xb();w.Wb(0,"as-split",1),w.ic("gutterDblClick",(function(){return w.Fc(i),w.kc().toggleFullscreen()}))("dragEnd",(function(e){return w.Fc(i),w.kc().dragEnd(e)})),w.Wb(1,"as-split-area",2),w.Mc(2,Q,2,2,"div",3),w.Vb(),w.Wb(3,"as-split-area",2),w.Wb(4,"div",4),w.Wb(5,"div",5),w.Wb(6,"a",6),w.ic("click",(function(){w.Fc(i);var e=w.kc();return e.showHideAllPurposes(!e.showAll)})),w.Rb(7,"fa-icon",7),w.Vb(),w.Vb(),w.Mc(8,B,8,6,"div",8),w.Wb(9,"div",9),w.Oc(10,"\xa0"),w.Vb(),w.Wb(11,"div",10),w.Wb(12,"div",11),w.Wb(13,"a",12),w.Oc(14," Purpose view "),w.Vb(),w.Wb(15,"a",13),w.Oc(16," Detail view "),w.Rb(17,"fa-icon",14),w.Vb(),w.Vb(),w.Vb(),w.Vb(),w.Vb(),w.Vb()}if(2&e){var s=w.kc();w.Cb(1),w.qc("size",s.columns[0].size),w.Cb(1),w.qc("ngIf",s.leftPaneSize>0),w.Cb(1),w.qc("size",s.columns[1].size),w.Cb(4),w.qc("icon",s.showAll?"angle-double-down":"angle-double-right"),w.Cb(1),w.qc("ngForOf",s.purpose)}}var G,Y,Z=((G=function(){function e(t){_classCallCheck(this,e),this.store$=t,this.edit=new w.n,this.showAll=!1,this.hideExtendedFields=!1,this.defaultLeftPaneSize=35,this.leftPaneSize=this.defaultLeftPaneSize,this.columns=[{visible:!0,size:this.defaultLeftPaneSize},{visible:!0,size:100-this.defaultLeftPaneSize}]}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.purpose$=this.store$.select((function(e){return e.issue.purpose})).subscribe((function(t){return e.purpose=t}));var t=this.store$.select((function(e){return e.issue.selectedIssue})).pipe(Object(P.a)((function(e){return e}))),i=this.store$.select((function(e){return e.issue.hierarchicalIssue})).pipe(Object(P.a)((function(e){return e})));this.combined$=Object(W.a)(t,i).subscribe((function(t){var i=_slicedToArray(t,2),s=i[0],n=i[1];e.selectedIssueKey=s.key,e.hierarchicalNode=n,setTimeout((function(){var t=Object(C.y)(n,s.key);t&&(Object(C.h)(s,t),e.store$.dispatch(new I(e.expandPurpose(t))))}),200)}))}},{key:"ngOnDestroy",value:function(){this.purpose$&&this.purpose$.unsubscribe(),this.combined$&&this.combined$.unsubscribe()}},{key:"showHideAllPurposes",value:function(e){var t=this;this.showAll=e,this.purpose&&(this.purpose.forEach((function(e){return e.show=t.showAll})),!this.showAll&&this.purpose.length>0&&(this.purpose[this.purpose.length-1].show=!0))}},{key:"expandPurpose",value:function(e){var t=[];return this.populatePurpose(e,t),j.reverse(t),t.length>0&&(t[t.length-1].show=!0),t}},{key:"populatePurpose",value:function(e,t){e&&(e.issueType!==C.a.EpicChildren&&e.issueType!==C.a.RelatedLink&&t.push({key:e.key,issueType:e.issueType,title:e.title,purpose:e.description,editable:e.editable,hfKey:e.hfKey,show:!1}),e.parent&&this.populatePurpose(e.parent,t))}},{key:"dragEnd",value:function(e){this.adjustPaneSize(e.sizes[0])}},{key:"adjustPaneSize",value:function(e){this.leftPaneSize=e,this.columns[0].size=e,this.columns[1].size=100-e}},{key:"toggleFullscreen",value:function(){this.adjustPaneSize(0===this.leftPaneSize?this.defaultLeftPaneSize:0)}}]),e}()).\u0275fac=function(e){return new(e||G)(w.Qb(n.h))},G.\u0275cmp=w.Kb({type:G,selectors:[["app-purpose"]],outputs:{edit:"edit"},decls:1,vars:1,consts:[["direction","horizontal",3,"gutterDblClick","dragEnd",4,"ngIf"],["direction","horizontal",3,"gutterDblClick","dragEnd"],[3,"size"],[4,"ngIf"],[1,"alert"],[1,"border-0","pb-0","mb-2","float-left"],["title","Show/hide details",1,"btn","btn-light","btn-sm","text-muted","mr-2",3,"click"],["size","fw",3,"icon"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"clearfix"],[1,"proceed-button","text-right"],[1,"btn","btn-group","btn-group-sm"],[1,"btn","btn-sm","btn-default","disabled"],["routerLink","../workbench",1,"btn","btn-sm","btn-primary"],["icon","arrow-circle-right","size","sm",1,"ml-1"],[3,"rootNode","issueKey"],[3,"ngClass"],[1,"text-uppercase","text-muted"],[1,"small"],["class","ml-3 pl-3 pr-3 border-left","style","overflow:auto",4,"ngIf"],[1,"ml-3","pl-3","pr-3","border-left",2,"overflow","auto"],[1,"text-dark","font-weight-normal","mt-1"],[3,"data"]],template:function(e,t){1&e&&w.Mc(0,J,18,5,"as-split",0),2&e&&w.qc("ngIf",t.purpose&&t.purpose.length>0)},directives:[s.n,F.c,F.b,R.a,s.m,q.f,A,s.l,K.a],encapsulation:2}),G),ee=i("pl0p"),te=i("3Pt+"),ie=i("jLSX"),se=i("lJxs"),ne=["content"],ce=((Y=function(){function e(t,i){_classCallCheck(this,e),this.cdRef=t,this.store$=i,this.containerSize=0,this.expandableSize=57,this.contentHeight=0,this.compactView=!1}return _createClass(e,[{key:"init",value:function(e){var t=this;this.containerSize=e,this.isSelectedIssueViewCompact$=this.store$.select((function(e){return e.issue.isSelectedIssueViewCompact})).subscribe((function(e){t.compactView=e,t.containerSize+=e?-1*t.expandableSize:t.expandableSize,t.onResize()}))}},{key:"destroy",value:function(){this.isSelectedIssueViewCompact$&&this.isSelectedIssueViewCompact$.unsubscribe()}},{key:"afterViewInit",value:function(){this.onResize()}},{key:"onResize",value:function(){this.elementView&&(this.contentHeight=this.elementView.nativeElement.offsetParent.clientHeight-this.containerSize,this.cdRef.detectChanges())}}]),e}()).\u0275fac=function(e){return new(e||Y)(w.Qb(w.h),w.Qb(n.h))},Y.\u0275dir=w.Lb({type:Y,viewQuery:function(e,t){var i;1&e&&w.Sc(ne,!0),2&e&&w.Cc(i=w.jc())&&(t.elementView=i.first)},hostBindings:function(e,t){1&e&&w.ic("resize",(function(e){return t.onResize(e)}),!1,w.Ec)}}),Y),ae=i("pMU3"),re=i("AQDj"),oe=i("eI62"),le=function(e){return["/browse",e]};function ue(e,t){if(1&e&&(w.Wb(0,"li",14),w.Wb(1,"a",15),w.Oc(2),w.Vb(),w.Vb()),2&e){var i=w.kc(3);w.Cb(1),w.qc("routerLink",w.uc(3,le,i.primaryIssue.key)),w.Cb(1),w.Rc(" ",i.primaryIssue.issueType,": ",i.primaryIssue.key," ")}}var de=function(){return["/search/list"]},be=function(e){return{"issue-resolved":e}},pe=function(e,t,i){return{"badge-success":e,"badge-warning":t,"badge-secondary":i}};function he(e,t){if(1&e&&(w.Wb(0,"nav",12),w.Wb(1,"ol",13),w.Wb(2,"li",14),w.Wb(3,"a",15),w.Rb(4,"fa-icon",16),w.Oc(5," Results "),w.Vb(),w.Vb(),w.Mc(6,ue,3,5,"li",17),w.Wb(7,"li",18),w.Wb(8,"span",19),w.Oc(9),w.Vb(),w.Wb(10,"span",20),w.Oc(11),w.Vb(),w.Rb(12,"app-issue-navigation-menu",21),w.Vb(),w.Vb(),w.Vb()),2&e){var i=w.kc(2);w.Cb(3),w.qc("routerLink",w.tc(10,de)),w.Cb(3),w.qc("ngIf",i.primaryIssue&&!i.primaryAndSelectIssueSame),w.Cb(2),w.qc("title",i.selectedIssue.resolution)("ngClass",w.uc(11,be,i.selectedIssue.resolution)),w.Cb(1),w.Rc(" ",i.selectedIssue.issueType,": ",i.selectedIssue.key," "),w.Cb(1),w.qc("ngClass",w.wc(13,pe,i.selectedIssue.resolution,!i.selectedIssue.resolution&&i.selectedIssue.duedateMissing,!i.selectedIssue.resolution&&!i.selectedIssue.duedateMissing)),w.Cb(1),w.Qc(" ",i.selectedIssue.status," "),w.Cb(1),w.qc("issueKey",i.selectedIssue.key)("spread",!0)}}var fe=function(){return["far","map"]};function ge(e,t){1&e&&(w.Wb(0,"a",31),w.Rb(1,"fa-icon",32),w.Wb(2,"span",27),w.Oc(3,"Storyboard"),w.Vb(),w.Vb()),2&e&&(w.qc("routerLinkActive","active"),w.Cb(1),w.qc("icon",w.tc(2,fe)))}function ye(e,t){1&e&&(w.Wb(0,"a",33),w.Rb(1,"fa-icon",34),w.Wb(2,"span",27),w.Oc(3,"Timeline"),w.Vb(),w.Vb()),2&e&&w.qc("routerLinkActive","active")}function me(e,t){if(1&e){var i=w.Xb();w.Wb(0,"div",35),w.Wb(1,"button",36),w.ic("click",(function(){return w.Fc(i),w.kc(3).linkIssueVisible=!0})),w.Rb(2,"fa-icon",37),w.Oc(3," Link issue "),w.Vb(),w.Vb()}}var Ie=function(){return["details"]};function ve(e,t){if(1&e&&(w.Wb(0,"div",22),w.Wb(1,"div",23),w.Wb(2,"div",24),w.Wb(3,"a",25),w.Rb(4,"fa-icon",26),w.Wb(5,"span",27),w.Oc(6,"Purpose"),w.Vb(),w.Vb(),w.Mc(7,ge,4,3,"a",28),w.Mc(8,ye,4,1,"a",29),w.Vb(),w.Vb(),w.Mc(9,me,4,0,"div",30),w.Vb()),2&e){var i=w.kc(2);w.Cb(3),w.qc("routerLink",w.tc(5,Ie))("routerLinkActive","active"),w.Cb(4),w.qc("ngIf",i.canNavigateToStoryboard),w.Cb(1),w.qc("ngIf",i.canNavigateToStoryboard),w.Cb(1),w.qc("ngIf",!i.selectedIssue.resolution)}}function ke(e,t){if(1&e){var i=w.Xb();w.Wb(0,"div",5),w.Wb(1,"div",6),w.Wb(2,"button",7),w.ic("click",(function(){return w.Fc(i),w.kc().toggleView()})),w.Rb(3,"fa-icon",8),w.Vb(),w.Vb(),w.Mc(4,he,13,17,"nav",9),w.Wb(5,"uicontrols-textbox",10),w.ic("textUpdated",(function(e){return w.Fc(i),w.kc().onTitleUpdated(e)})),w.Vb(),w.Mc(6,ve,10,6,"div",11),w.Vb()}if(2&e){var s=w.kc();w.Cb(3),w.qc("icon",s.compactView?"expand-alt":"compress-alt"),w.Cb(1),w.qc("ngIf",!s.compactView),w.Cb(1),w.qc("text",s.selectedIssue.title)("canEdit",!s.selectedIssue.resolution),w.Cb(1),w.qc("ngIf",!s.compactView)}}function Ce(e,t){if(1&e){var i=w.Xb();w.Wb(0,"app-link-issue",38),w.ic("close",(function(e){return w.Fc(i),w.kc().linkIssueCompleted(e)}))("issueLinked",(function(e){return w.Fc(i),w.kc().onIssueLinked(e)})),w.Vb()}if(2&e){var s=w.kc();w.qc("issue",s.selectedIssue)}}var Oe,je=((Oe=function(e){function t(e,i,s,n){var c;return _classCallCheck(this,t),(c=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n))).cdRef=e,c.router=i,c.activatedRoute=s,c.store$=n,c.canNavigateToStoryboard=!1,c.primaryAndSelectIssueSame=!1,c.checkIsPrimaryAndSelectIssueSame=function(){return c.selectedIssue&&c.selectedIssue.key&&c.primaryIssue&&c.primaryIssue.key&&c.primaryIssue.key.toLowerCase()===c.selectedIssue.key.toLowerCase()},c.showIssueEntry=!1,c.linkIssueVisible=!1,c.createIssueVisible=!1,c}return _inherits(t,e),_createClass(t,[{key:"ngOnInit",value:function(){var e=this;this.init(45),this.localNodeType=C.a,this.updatedField$=this.store$.select((function(e){return e.issue.updatedField})).pipe(Object(P.a)((function(t){return t&&e.selectedIssue}))).subscribe((function(){e.store$.dispatch(new p({issue:e.selectedIssue.key,extendedFields:e.extendedFields}))})),this.organization$=this.store$.select((function(e){return e.app.organization})).pipe(Object(P.a)((function(e){return e}))).subscribe((function(t){return e.store$.dispatch(new v(t))})),this.selectedIssue$=this.store$.select((function(e){return e.issue.selectedIssue})).pipe(Object(P.a)((function(e){return e}))).subscribe((function(t){e.compactView=!1,e.selectedIssue=t,e.primaryAndSelectIssueSame=e.checkIsPrimaryAndSelectIssueSame(),e.canNavigateToStoryboard=e.primaryAndSelectIssueSame,e.primaryIssue&&e.primaryIssue.key&&e.selectedIssue.key.toLowerCase()===e.primaryIssue.key.toLowerCase()||(e.selectedIssue.relatedLinksLoaded||e.selectedIssue.relatedLinksLoading||e.selectedIssue.relatedLinks&&e.selectedIssue.relatedLinks.length>0&&e.store$.dispatch(new g(j.map(e.selectedIssue.relatedLinks,"key"))),e.selectedIssue.issueType!==C.a.Epic||e.selectedIssue.epicChildrenLoaded||e.selectedIssue.epicChildrenLoading||e.store$.dispatch(new f(e.selectedIssue.key)))}));var t=this.store$.select((function(e){return e.issue.primaryIssue})).pipe(Object(P.a)((function(e){return e}))),i=this.store$.select((function(e){return e.issue.hierarchicalIssue})).pipe(Object(P.a)((function(e){return e}))),s=this.activatedRoute.params.pipe(Object(P.a)((function(e){return e&&e.selected&&e.selected.length>0})),Object(se.a)((function(e){return e.selected})));this.combined$=Object(W.a)(t,i,s).subscribe((function(t){var i=_slicedToArray(t,3),s=i[0],n=i[1],c=i[2];if(e.primaryIssue=s,e.primaryIssue.key&&c.toLowerCase()===e.primaryIssue.key.toLowerCase())e.store$.dispatch(new y(s));else if(!e.selectedIssue||e.selectedIssue.key.toLowerCase()!==c.toLowerCase()){var a=Object(C.y)(n,c);e.extendedFields=a?e.populateExtendedFields(s.projectConfig,a.issueType):[],e.store$.dispatch(new p({issue:c,extendedFields:e.extendedFields}))}}))}},{key:"populateExtendedFields",value:function(e,t){var i=[];if(e){if(e.standardIssueTypes){var s=j.find(e.standardIssueTypes,{name:t});s&&(i=j.union(i,s.list))}e.startdate&&i.push(e.startdate)}return i}},{key:"ngOnDestroy",value:function(){this.destroy(),this.updatedField$&&this.updatedField$.unsubscribe(),this.organization$&&this.organization$.unsubscribe(),this.combined$&&this.combined$.unsubscribe(),this.selectedIssue$&&this.selectedIssue$.unsubscribe()}},{key:"onShowIssuelist",value:function(){this.router.navigate(["/search/list"])}},{key:"ngAfterViewInit",value:function(){this.afterViewInit()}},{key:"toggleView",value:function(){this.store$.dispatch(new h(!this.compactView))}},{key:"onCancelIssueEntry",value:function(e){this.showIssueEntry=!1}},{key:"onTitleUpdated",value:function(e){this.store$.dispatch(new k({issueKey:this.selectedIssue.key,fieldName:"summary",updatedValue:e.updated})),this.selectedIssue.title=e.updated}},{key:"linkIssueCompleted",value:function(e){this.linkIssueVisible=!1}},{key:"onIssueLinked",value:function(e){}},{key:"createIssueCompleted",value:function(e){this.linkIssueVisible=!1}},{key:"onIssueCreated",value:function(e){}}]),t}(ce)).\u0275fac=function(e){return new(e||Oe)(w.Qb(w.h),w.Qb(q.d),w.Qb(q.a),w.Qb(n.h))},Oe.\u0275cmp=w.Kb({type:Oe,selectors:[["app-selected-issue-container"]],features:[w.zb],decls:6,vars:5,consts:[["class","bg-light container-fluid pb-1 border-bottom",4,"ngIf"],[2,"overflow","auto","width","100%"],["content",""],["styleClass","ui-sidebar-md","position","right",3,"visible","visibleChange","onHide"],[3,"issue","close","issueLinked",4,"ngIf"],[1,"bg-light","container-fluid","pb-1","border-bottom"],[1,"float-right","btn-group","btn-group-sm"],[1,"btn","btn-sm","btn-link","text-muted",3,"click"],[3,"icon"],["aria-label","breadcrumb",4,"ngIf"],["styleClass","h2 font-weight-light mb-0 text-truncate",3,"text","canEdit","textUpdated"],["class","row",4,"ngIf"],["aria-label","breadcrumb"],[1,"breadcrumb","small","bg-light","p-0","m-0"],[1,"breadcrumb-item"],[1,"text-uppercase",3,"routerLink"],["icon","search",1,"mr-1"],["class","breadcrumb-item",4,"ngIf"],["aria-current","page",1,"breadcrumb-item","active"],[1,"text-uppercase","text-dark",3,"title","ngClass"],[1,"badge","text-truncate","ml-2",3,"ngClass"],[1,"ml-3",3,"issueKey","spread"],[1,"row"],[1,"col-md-6"],[1,"btn-group"],["title","View purpose",1,"btn","btn-default","border","btn-sm","text-nowrap",3,"routerLink","routerLinkActive"],["icon","fire","size","sm",1,"text-brand"],[1,"ml-1"],["class","btn btn-default border btn-sm text-nowrap","routerLink","storyboard","title","Storyboard",3,"routerLinkActive",4,"ngIf"],["class","btn btn-default border btn-sm text-nowrap","routerLink","timeline","title","Timeline",3,"routerLinkActive",4,"ngIf"],["class","col-md-6 text-right",4,"ngIf"],["routerLink","storyboard","title","Storyboard",1,"btn","btn-default","border","btn-sm","text-nowrap",3,"routerLinkActive"],["size","sm",3,"icon"],["routerLink","timeline","title","Timeline",1,"btn","btn-default","border","btn-sm","text-nowrap",3,"routerLinkActive"],["icon","map-signs","size","sm"],[1,"col-md-6","text-right"],[1,"btn","btn-sm","btn-link",3,"click"],["icon","link","size","sm",1,"mr-1"],[3,"issue","close","issueLinked"]],template:function(e,t){1&e&&(w.Mc(0,ke,7,5,"div",0),w.Wb(1,"div",1,2),w.Rb(3,"router-outlet"),w.Vb(),w.Wb(4,"p-sidebar",3),w.ic("visibleChange",(function(e){return t.linkIssueVisible=e}))("onHide",(function(e){return t.linkIssueCompleted(e)})),w.Mc(5,Ce,1,1,"app-link-issue",4),w.Vb()),2&e&&(w.qc("ngIf",t.selectedIssue),w.Cb(1),w.Lc("height",t.contentHeight,"px"),w.Cb(3),w.qc("visible",t.linkIssueVisible),w.Cb(1),w.qc("ngIf",t.selectedIssue))},directives:[s.n,q.h,ie.a,R.a,ae.a,q.f,s.l,re.a,q.e,oe.a],encapsulation:2}),Oe),Le=i("1kSV"),Se=i("ulIy"),Ve=i("wQv3"),we=i("OTNj"),We=i("29oc"),Pe=i("atTx"),Fe=i("yWCo"),Re=i("O5Lx");function qe(e,t){if(1&e&&(w.Wb(0,"div"),w.Rb(1,"app-extended-fields",6),w.Rb(2,"app-attachments",6),w.Vb()),2&e){var i=w.kc(2);w.Cb(1),w.qc("issue",i.issue),w.Cb(1),w.qc("issue",i.issue)}}function xe(e,t){if(1&e&&w.Rb(0,"fa-icon",26),2&e){var i=w.kc(3);w.qc("icon",i.allEpicChildrenVisible?"angle-double-down":"angle-double-right")("fixedWidth",!0)}}function ze(e,t){1&e&&(w.Wb(0,"div",29),w.Oc(1," There are no issues in this epic "),w.Vb())}function Ee(e,t){if(1&e){var i=w.Xb();w.Wb(0,"div"),w.Wb(1,"app-grouped-issues",30),w.ic("fieldUpdated",(function(e){return w.Fc(i),w.kc(4).onFieldUpdated(e)})),w.Vb(),w.Vb()}if(2&e){var s=w.kc(4);w.Cb(1),w.qc("groupedIssues",s.groupedEpicChildren)("projectConfig",s.issue.projectConfig)}}function $e(e,t){if(1&e&&(w.Wb(0,"div",27),w.Mc(1,ze,2,0,"div",28),w.Mc(2,Ee,2,2,"div",7),w.Vb()),2&e){var i=w.kc(3);w.Cb(1),w.qc("ngIf",!i.groupedEpicChildren||0===i.groupedEpicChildren.length),w.Cb(1),w.qc("ngIf",i.groupedEpicChildren&&i.groupedEpicChildren.length>0)}}function Te(e,t){if(1&e){var i=w.Xb();w.Wb(0,"li",19),w.Wb(1,"a",20),w.ic("click",(function(){return w.Fc(i),w.kc(2).toggleAllEpicChildren()})),w.Mc(2,xe,1,2,"fa-icon",25),w.Oc(3," Issues in epic "),w.Vb(),w.Mc(4,$e,3,2,"ng-template",22),w.Vb()}if(2&e){var s=w.kc(2);w.qc("ngbNavItem",1),w.Cb(2),w.qc("ngIf",s.groupedEpicChildren&&s.groupedEpicChildren.length>1)}}function Me(e,t){if(1&e&&w.Rb(0,"fa-icon",26),2&e){var i=w.kc(3);w.qc("icon",i.allRelatedIssuesVisible?"angle-double-down":"angle-double-right")("fixedWidth",!0)}}function _e(e,t){if(1&e){var i=w.Xb();w.Wb(0,"div",27),w.Wb(1,"app-grouped-issues",30),w.ic("fieldUpdated",(function(e){return w.Fc(i),w.kc(3).onFieldUpdated(e)})),w.Vb(),w.Vb()}if(2&e){var s=w.kc(3);w.Cb(1),w.qc("groupedIssues",s.groupedRelatedLinks)("projectConfig",s.issue.projectConfig)}}function Ne(e,t){if(1&e){var i=w.Xb();w.Wb(0,"li",19),w.Wb(1,"a",20),w.ic("click",(function(){return w.Fc(i),w.kc(2).toggleAllRelatedIssues()})),w.Mc(2,Me,1,2,"fa-icon",25),w.Oc(3," Related "),w.Vb(),w.Mc(4,_e,2,2,"ng-template",22),w.Vb()}if(2&e){var s=w.kc(2);w.qc("ngbNavItem",2),w.Cb(2),w.qc("ngIf",s.groupedRelatedLinks.length>1)}}function De(e,t){if(1&e){var i=w.Xb();w.Wb(0,"div",27),w.Wb(1,"app-task-list",31),w.ic("fieldUpdated",(function(e){return w.Fc(i),w.kc(2).onFieldUpdated(e)})),w.Vb(),w.Vb()}if(2&e){var s=w.kc(2);w.Cb(1),w.qc("issue",s.selectedIssue)("showIssue",!1)}}function Ue(e,t){if(1&e&&(w.Wb(0,"div",32),w.Rb(1,"app-comment-list",33),w.Vb()),2&e){var i=w.kc(2);w.Cb(1),w.qc("issueKey",i.issue.key)}}var Ae=function(e){return{small:e}},Ke=function(){return["far","comments"]};function Qe(e,t){if(1&e){var i=w.Xb();w.Wb(0,"as-split",1),w.ic("gutterDblClick",(function(){return w.Fc(i),w.kc().toggleFullscreen()}))("dragEnd",(function(e){return w.Fc(i),w.kc().dragEnd(e)})),w.Wb(1,"as-split-area",2),w.Wb(2,"div",3),w.Wb(3,"uicontrols-textarea",4),w.ic("textUpdated",(function(e){return w.Fc(i),w.kc().onDescUpdated(e)})),w.Vb(),w.Wb(4,"div",5),w.Rb(5,"app-issue-metafields",6),w.Vb(),w.Mc(6,qe,3,2,"div",7),w.Wb(7,"div",8),w.Wb(8,"div",9),w.Wb(9,"a",10),w.Rb(10,"fa-icon",11),w.Oc(11," Purpose view "),w.Vb(),w.Wb(12,"a",12),w.Oc(13," Detail view "),w.Vb(),w.Vb(),w.Vb(),w.Vb(),w.Vb(),w.Wb(14,"as-split-area",13),w.Wb(15,"button",14),w.ic("click",(function(){return w.Fc(i),w.kc().toggleFullscreen()})),w.Rb(16,"fa-icon",15),w.Vb(),w.Wb(17,"ul",16,17),w.ic("activeIdChange",(function(e){return w.Fc(i),w.kc().selectedTab=e})),w.Mc(19,Te,5,2,"li",18),w.Mc(20,Ne,5,2,"li",18),w.Wb(21,"li",19),w.Wb(22,"a",20),w.ic("click",(function(){return w.Fc(i),w.kc().reloadSubtasks()})),w.Rb(23,"fa-icon",21),w.Oc(24," Task breakup "),w.Vb(),w.Mc(25,De,2,2,"ng-template",22),w.Vb(),w.Wb(26,"li",19),w.Wb(27,"a",20),w.ic("click",(function(){return w.Fc(i),w.kc().reloadSubtasks()})),w.Rb(28,"fa-icon",23),w.Oc(29," Comments "),w.Vb(),w.Mc(30,Ue,2,1,"ng-template",22),w.Vb(),w.Vb(),w.Rb(31,"div",24),w.Vb(),w.Vb()}if(2&e){var s=w.Dc(18),n=w.kc();w.Cb(1),w.qc("size",n.columns[0].size),w.Cb(2),w.qc("text",n.issue.description)("forceSave",!0)("canEdit",!n.issue.resolution),w.Cb(2),w.qc("issue",n.issue),w.Cb(1),w.qc("ngIf",n.leftPaneSize>0),w.Cb(8),w.qc("size",n.columns[1].size)("ngClass",w.uc(18,Ae,0!==n.columns[0].size)),w.Cb(2),w.qc("icon",0===n.columns[0].size?"compress":"expand")("fixedWidth",!0),w.Cb(1),w.qc("activeId",n.selectedTab)("destroyOnHide",!1),w.Cb(2),w.qc("ngIf",n.issue.issueType===n.localNodeType.Epic),w.Cb(1),w.qc("ngIf",n.groupedRelatedLinks&&n.groupedRelatedLinks.length>0),w.Cb(1),w.qc("ngbNavItem",3),w.Cb(5),w.qc("ngbNavItem",4),w.Cb(2),w.qc("icon",w.tc(20,Ke)),w.Cb(3),w.qc("ngbNavOutlet",s)}}var He,Xe=((He=function(){function e(t){var i=this;_classCallCheck(this,e),this.store$=t,this.allRelatedIssuesVisible=!0,this.allEpicChildrenVisible=!0,this.selectedTab=1,this.leftPaneSize=60,this.columns=[{visible:!0,size:60},{visible:!0,size:40}],this.resetSelectedEpicIssue=function(){return i.selectedEpicIssue=null},this.localNodeType=C.a}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.selectedIssue$=this.store$.select((function(e){return e.issue.selectedIssue})).pipe(Object(P.a)((function(e){return e}))).subscribe((function(t){e.issue=t,e.selectedRelatedIssue=null,e.selectedEpicIssue=null,e.issue.relatedLinksLoaded&&!e.groupedRelatedLinks&&(e.groupedRelatedLinks=Object(a.a)(e.issue.relatedLinks,"linkType"),e.issue.relatedLinksCount=e.groupedRelatedLinks.length,e.selectedTab=e.groupedRelatedLinks.length>0?2:3,e.toggleAllRelatedIssues()),e.issue.issueType===C.a.Epic&&e.issue.epicChildrenLoaded&&e.groupEpicChildren("status")}))}},{key:"ngOnDestroy",value:function(){this.epicChildrenLoaded$&&this.epicChildrenLoaded$.unsubscribe(),this.selectedIssue$&&this.selectedIssue$.unsubscribe()}},{key:"dragEnd",value:function(e){this.adjustPaneSize(e.sizes[0])}},{key:"adjustPaneSize",value:function(e){this.leftPaneSize=e,this.columns[0].size=e,this.columns[1].size=100-e}},{key:"toggleFullscreen",value:function(){this.adjustPaneSize(0===this.leftPaneSize?60:0)}},{key:"selectEpicIssue",value:function(e){this.selectedEpicIssue=e,this.selectedEpicIssue.projectConfig=this.issue.projectConfig}},{key:"groupEpicChildren",value:function(e){if(this.selectedTab=1,this.issue&&!this.groupedEpicChildren){var t=this.issue.epicChildren;t&&t.length>0&&(this.groupedEpicChildren=Object(a.a)(t,e)),this.toggleAllEpicChildren()}}},{key:"toggleAllEpicChildren",value:function(){var e=this;this.selectedIssue=null,this.allEpicChildrenVisible=!this.allEpicChildrenVisible,this.groupedEpicChildren&&this.groupedEpicChildren.forEach((function(t){return t.visible=1===e.groupedEpicChildren.length||e.allEpicChildrenVisible}))}},{key:"toggleAllRelatedIssues",value:function(){var e=this;this.selectedIssue=null,this.allRelatedIssuesVisible=!this.allRelatedIssuesVisible,this.groupedRelatedLinks&&this.groupedRelatedLinks.length>0&&this.groupedRelatedLinks.forEach((function(t){return t.visible=1===e.groupedRelatedLinks.length||e.allRelatedIssuesVisible}))}},{key:"reloadSubtasks",value:function(){this.selectedEpicIssue=null,this.selectedRelatedIssue=null,this.selectedIssue=this.issue}},{key:"onFieldUpdated",value:function(e){this.store$.dispatch(new k(e))}},{key:"onDescUpdated",value:function(e){this.onFieldUpdated({issueKey:this.issue.key,fieldName:"description",updatedValue:e.updated}),this.issue.description=e.updated}}]),e}()).\u0275fac=function(e){return new(e||He)(w.Qb(n.h))},He.\u0275cmp=w.Kb({type:He,selectors:[["app-workbench"]],decls:2,vars:1,consts:[["direction","horizontal",3,"gutterDblClick","dragEnd",4,"ngIf"],["direction","horizontal",3,"gutterDblClick","dragEnd"],[3,"size"],[1,"alert","mr-5",2,"overflow","auto"],["styleClass"," mb-4",3,"text","forceSave","canEdit","textUpdated"],[1,"small","alert","bg-light","mb-4"],[3,"issue"],[4,"ngIf"],[1,"proceed-button","text-right"],[1,"btn","btn-group","btn-group-sm"],["routerLink","../details",1,"btn","btn-sm","btn-primary"],["icon","arrow-circle-left","size","sm",1,"mr-1"],[1,"btn","btn-sm","btn-default","disabled"],[3,"size","ngClass"],["title","expand/collapse pane",1,"btn","btn-sm","btn-link","text-muted","float-right","mt-2",3,"click"],[3,"icon","fixedWidth"],["ngbNav","",1,"nav-tabs","mt-2",3,"activeId","destroyOnHide","activeIdChange"],["nav","ngbNav"],[3,"ngbNavItem",4,"ngIf"],[3,"ngbNavItem"],["ngbNavLink","",3,"click"],["icon","list"],["ngbNavContent",""],[3,"icon"],[1,"mt-2",3,"ngbNavOutlet"],["size","sm",3,"icon","fixedWidth",4,"ngIf"],["size","sm",3,"icon","fixedWidth"],[1,"pl-2","pr-2","pb-2"],["class","alert alert-warning",4,"ngIf"],[1,"alert","alert-warning"],[3,"groupedIssues","projectConfig","fieldUpdated"],[3,"issue","showIssue","fieldUpdated"],[1,"pl-2","pr-5","pb-2"],[3,"issueKey"]],template:function(e,t){1&e&&(w.Wb(0,"div"),w.Mc(1,Qe,32,21,"as-split",0),w.Vb()),2&e&&(w.Cb(1),w.qc("ngIf",t.issue))},directives:[s.n,F.c,F.b,Se.a,Ve.a,q.f,R.a,s.l,Le.j,Le.l,Le.m,Le.k,Le.o,we.a,We.a,Pe.a,Fe.a,Re.a],encapsulation:2}),He),Be=i("uAqM"),Je=i("Ewkv"),Ge=i("lVkt"),Ye=i("/RsI"),Ze=i("NGyg"),et=i("qUTn"),tt=function(e){return{"mt-2":e}};function it(e,t){if(1&e){var i=w.Xb();w.Wb(0,"div",18),w.Wb(1,"input",19),w.ic("ngModelChange",(function(e){return w.Fc(i),w.kc(2).includeEpicChildren=e}))("change",(function(){return w.Fc(i),w.kc(2).plotIssuesOnStoryboard()})),w.Vb(),w.Wb(2,"b",20),w.Oc(3),w.Vb(),w.Oc(4," issues in this epic "),w.Vb()}if(2&e){var s=w.kc(2);w.qc("ngClass",w.uc(3,tt,!s.storyboardItem.relatedLinks||0===s.storyboardItem.relatedLinks.length)),w.Cb(1),w.qc("ngModel",s.includeEpicChildren),w.Cb(2),w.Pc(s.storyboardItem.epicChildren.length)}}function st(e,t){if(1&e){var i=w.Xb();w.Wb(0,"div",18),w.Wb(1,"input",19),w.ic("ngModelChange",(function(e){return w.Fc(i),w.kc(2).includeRelatedIssues=e}))("change",(function(){return w.Fc(i),w.kc(2).plotIssuesOnStoryboard()})),w.Vb(),w.Wb(2,"b",20),w.Oc(3),w.Vb(),w.Oc(4," related issues "),w.Vb()}if(2&e){var s=w.kc(2);w.qc("ngClass",w.uc(3,tt,!s.storyboardItem.epicChildren||0===s.storyboardItem.epicChildren.length)),w.Cb(1),w.qc("ngModel",s.includeRelatedIssues),w.Cb(2),w.Pc(s.storyboardItem.relatedLinks.length)}}function nt(e,t){if(1&e&&(w.Wb(0,"div",22),w.Wb(1,"span",23),w.Oc(2),w.Vb(),w.Oc(3," unplanned issues. "),w.Vb()),2&e){var i=w.kc(3);w.qc("ngClass",w.uc(2,tt,0===i.storyboardItem.metadata.emptyRecordCount)),w.Cb(2),w.Pc(i.storyboardItem.metadata.backlogCount)}}function ct(e,t){if(1&e&&(w.Wb(0,"div",18),w.Wb(1,"span",23),w.Oc(2),w.Vb(),w.Oc(3),w.Vb()),2&e){var i=w.kc(3);w.qc("ngClass",w.uc(3,tt,0===i.storyboardItem.metadata.backlogCount)),w.Cb(2),w.Pc(i.storyboardItem.metadata.emptyRecordCount),w.Cb(1),w.Qc(" issues with unassigned ",i.groupByColumn,". ")}}function at(e,t){if(1&e&&(w.Ub(0),w.Mc(1,nt,4,4,"div",21),w.Mc(2,ct,4,5,"div",8),w.Tb()),2&e){var i=w.kc(2);w.Cb(1),w.qc("ngIf",i.storyboardItem.metadata.backlogCount>0),w.Cb(1),w.qc("ngIf",i.storyboardItem.metadata.emptyRecordCount>0)}}function rt(e,t){if(1&e){var i=w.Xb();w.Wb(0,"p-multiSelect",24),w.ic("ngModelChange",(function(e){return w.Fc(i),w.kc(2).selectedStatuses=e}))("onChange",(function(e){return w.Fc(i),w.kc(2).onSelectedStatusChange(e)})),w.Vb()}if(2&e){var s=w.kc(2);w.qc("options",s.statusLookup)("ngModel",s.selectedStatuses)}}var ot=function(){return["far","chart-bar"]};function lt(e,t){if(1&e){var i=w.Xb();w.Wb(0,"button",25),w.ic("click",(function(){return w.Fc(i),w.kc(2).showStatistics=!0})),w.Rb(1,"fa-icon",26),w.Vb()}2&e&&(w.Cb(1),w.qc("icon",w.tc(1,ot)))}function ut(e,t){if(1&e){var i=w.Xb();w.Wb(0,"p-dialog",27),w.ic("visibleChange",(function(e){return w.Fc(i),w.kc(2).showStatistics=e})),w.Rb(1,"app-statistics",28),w.Vb()}if(2&e){var s=w.kc(2);w.qc("header",s.storyboardItem.statistics.title)("dismissableMask",!0)("modal",!0)("visible",s.showStatistics),w.Cb(1),w.qc("groupByColumn",s.groupByColumn)("statistics",s.storyboardItem.statistics)}}function dt(e,t){if(1&e){var i=w.Xb();w.Wb(0,"app-issue-details",29),w.ic("currentIndexChange",(function(e){return w.Fc(i),w.kc(2).currentIndex=e}))("close",(function(){return w.Fc(i),w.kc(2).issueDetailsVisible=!1}))("fieldUpdated",(function(e){return w.Fc(i),w.kc(2).onFieldUpdated(e)})),w.Vb()}if(2&e){var s=w.kc(2);w.qc("list",s.storyboardItem.children)("currentIndex",s.currentIndex)("enableEdits",!0)}}function bt(e,t){if(1&e){var i=w.Xb();w.Wb(0,"div"),w.Wb(1,"div",1),w.Wb(2,"div",2),w.Wb(3,"div",3),w.Wb(4,"select",4),w.ic("ngModelChange",(function(e){return w.Fc(i),w.kc().groupByColumn=e}))("change",(function(){return w.Fc(i),w.kc().onGroupByColumnChanged()})),w.Wb(5,"option",5),w.Oc(6,"Components"),w.Vb(),w.Wb(7,"option",6),w.Oc(8,"Labels"),w.Vb(),w.Vb(),w.Vb(),w.Wb(9,"div",7),w.Mc(10,it,5,5,"div",8),w.Mc(11,st,5,5,"div",8),w.Vb(),w.Wb(12,"div",9),w.Mc(13,at,3,2,"ng-container",0),w.Vb(),w.Wb(14,"div",10),w.Mc(15,rt,1,2,"p-multiSelect",11),w.Vb(),w.Wb(16,"div",12),w.Mc(17,lt,2,2,"button",13),w.Vb(),w.Vb(),w.Vb(),w.Wb(18,"app-storyboard-renderer",14),w.ic("itemSelected",(function(e){return w.Fc(i),w.kc().onItemSelected(e)}))("fieldValueChange",(function(e){return w.Fc(i),w.kc().onFieldUpdated(e)})),w.Vb(),w.Mc(19,ut,2,6,"p-dialog",15),w.Wb(20,"p-sidebar",16),w.ic("visibleChange",(function(e){return w.Fc(i),w.kc().issueDetailsVisible=e})),w.Mc(21,dt,1,3,"app-issue-details",17),w.Vb(),w.Vb()}if(2&e){var s=w.kc();w.Cb(4),w.qc("ngModel",s.groupByColumn),w.Cb(6),w.qc("ngIf",s.storyboardItem.epicChildren&&s.storyboardItem.epicChildren.length>0),w.Cb(1),w.qc("ngIf",s.storyboardItem.relatedLinks&&s.storyboardItem.relatedLinks.length>0),w.Cb(2),w.qc("ngIf",s.storyboardItem.metadata),w.Cb(2),w.qc("ngIf",s.statusLookup&&s.statusLookup.length>0),w.Cb(2),w.qc("ngIf",s.storyboardItem.epicChildren&&s.storyboardItem.epicChildren.length>0||s.storyboardItem.relatedLinks&&s.storyboardItem.relatedLinks.length>0),w.Cb(1),w.qc("groupByColumn",s.groupByColumn)("storyboardItem",s.storyboardItem),w.Cb(1),w.qc("ngIf",s.storyboardItem&&s.storyboardItem.statistics),w.Cb(1),w.qc("visible",s.issueDetailsVisible)("fullScreen",!0)("showCloseIcon",!1),w.Cb(1),w.qc("ngIf",s.storyboardItem&&s.storyboardItem.children)}}var pt,ht,ft,gt=((pt=function(){function e(t){_classCallCheck(this,e),this.store$=t,this.selectedStatuses=[],this.statusLookup=[],this.includeRelatedIssues=!1,this.relatedIssuesIncluded=!1,this.includeEpicChildren=!1,this.epicChildrenIncluded=!1,this.showStatistics=!1,this.groupByColumn="components",this.filterByStatus=function(e,t){return t&&t.length>0?j.filter(e,(function(e){return void 0!==j.find(t,(function(t){return t===e.status}))})):e},this.issueDetailsVisible=!1,this.currentIndex=0}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.selectedItem$=this.store$.select((function(e){return e.issue.selectedIssue})).pipe(Object(P.a)((function(e){return e}))).subscribe((function(t){e.storyboardItem=j.pick(t,j.union(C.w,["relatedLinks","epicChildren"])),t.issueType===C.a.Epic?e.includeEpicChildren=!0:e.includeRelatedIssues=!0,e.plotIssuesOnStoryboard()}))}},{key:"ngOnDestroy",value:function(){this.selectedItem$&&this.selectedItem$.unsubscribe()}},{key:"onGroupByColumnChanged",value:function(){this.plotIssuesOnStoryboard()}},{key:"plotIssuesOnStoryboard",value:function(){this.storyboardItem.children=[],this.storyboardItem.metadata=Object(Be.b)(this.groupByColumn);var e=j.map(this.selectedStatuses,"key");if(this.includeEpicChildren&&this.storyboardItem.epicChildren&&this.storyboardItem.epicChildren.length>0){this.epicChildrenIncluded=!0;var t=this.filterByStatus(this.storyboardItem.epicChildren,e);this.storyboardItem.children=j.union(this.storyboardItem.children,t),Object(Be.c)(this.storyboardItem.metadata,Object(Be.a)(t,this.groupByColumn),this.groupByColumn)}if(this.includeRelatedIssues&&this.storyboardItem.relatedLinks&&this.storyboardItem.relatedLinks.length>0){this.relatedIssuesIncluded=!0;var i=this.filterByStatus(this.storyboardItem.relatedLinks,e);this.storyboardItem.children=j.union(this.storyboardItem.children,i),Object(Be.c)(this.storyboardItem.metadata,Object(Be.a)(i,this.groupByColumn),this.groupByColumn)}this.storyboardItem.statistics=Object(Be.d)(this.storyboardItem.metadata,this.storyboardItem.children,"Statistics",this.groupByColumn),this.storyboardItem.statistics&&this.statusLookup&&0===this.statusLookup.length&&(this.statusLookup=this.storyboardItem.statistics.status)}},{key:"onSelectedStatusChange",value:function(e){this.plotIssuesOnStoryboard()}},{key:"openIssueAtIndex",value:function(e){this.issueDetailsVisible=!0,this.currentIndex=e}},{key:"onItemSelected",value:function(e){if(this.storyboardItem.children&&e&&e.issueKey){var t=j.findIndex(this.storyboardItem.children,{key:e.issueKey});t>=0&&this.openIssueAtIndex(t)}}},{key:"onFieldUpdated",value:function(e){this.store$.dispatch(new k(e))}}]),e}()).\u0275fac=function(e){return new(e||pt)(w.Qb(n.h))},pt.\u0275cmp=w.Kb({type:pt,selectors:[["app-storyboard"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"pl-3","pt-2","pb-2","pr-2"],[1,"row","small"],[1,"col-md-2","col-lg-2","pt-1"],[1,"form-control","form-control-sm",2,"width","150px",3,"ngModel","ngModelChange","change"],["value","components"],["value","labels"],[1,"col-md-3","offset-lg-1","col-lg-2"],[3,"ngClass",4,"ngIf"],[1,"col-md-3","col-lg-4","text-truncate"],[1,"col-md-3","col-lg-2","pt-1"],["styleClass","w-100","defaultLabel","Filter","optionLabel","key",3,"options","ngModel","ngModelChange","onChange",4,"ngIf"],[1,"col-md-1","text-right"],["class","btn btn-link pr-0",3,"click",4,"ngIf"],[3,"groupByColumn","storyboardItem","itemSelected","fieldValueChange"],["position","right","class","bg-light",3,"header","dismissableMask","modal","visible","visibleChange",4,"ngIf"],["styleClass","bg-light",3,"visible","fullScreen","showCloseIcon","visibleChange"],[3,"list","currentIndex","enableEdits","currentIndexChange","close","fieldUpdated",4,"ngIf"],[3,"ngClass"],["type","checkbox",3,"ngModel","ngModelChange","change"],[1,"badge","badge-success","ml-1"],["class","mr-4",3,"ngClass",4,"ngIf"],[1,"mr-4",3,"ngClass"],[1,"badge","badge-warning"],["styleClass","w-100","defaultLabel","Filter","optionLabel","key",3,"options","ngModel","ngModelChange","onChange"],[1,"btn","btn-link","pr-0",3,"click"],["size","lg",3,"icon"],["position","right",1,"bg-light",3,"header","dismissableMask","modal","visible","visibleChange"],[3,"groupByColumn","statistics"],[3,"list","currentIndex","enableEdits","currentIndexChange","close","fieldUpdated"]],template:function(e,t){1&e&&w.Mc(0,bt,22,13,"div",0),2&e&&w.qc("ngIf",t.storyboardItem)},directives:[s.n,te.k,te.f,te.i,te.j,te.l,Je.a,ie.a,s.l,te.a,Ge.a,R.a,Ye.a,Ze.a,et.a],encapsulation:2}),pt),yt=i("snw9"),mt=i("mrSG"),It=i("eIep"),vt=i("JIr8"),kt=i("vkgz"),Ct=i("LRne"),Ot=i("F2Ol"),jt=i("yVuU"),Lt=((ht=function(){function e(t,i,s){var n=this;_classCallCheck(this,e),this.actions$=t,this.jiraService=i,this.cachingService=s,this.loadPrimaryIssue=this.actions$.pipe(Object(yt.d)(r.LoadPrimaryIssue),Object(It.a)((function(e){return n.getIssueDetails(e.payload).pipe(Object(se.a)((function(e){return{type:r.LoadPrimaryIssueSuccess,payload:e}})),Object(vt.a)((function(){return Object(Ct.a)({type:r.LoadPrimaryIssueFailed})})))}))),this.loadPrimaryIssueEpicChildren=this.actions$.pipe(Object(yt.d)(r.LoadPrimaryIssueEpicChildren),Object(It.a)((function(e){return n.jiraService.loadEpicChildren$(e.payload,0,100,C.m).pipe(Object(se.a)((function(e){return{type:r.LoadPrimaryIssueEpicChildrenSuccess,payload:e}})),Object(vt.a)((function(){return Object(Ct.a)({type:r.LoadPrimaryIssueEpicChildrenFailed})})))}))),this.loadPrimaryIssueRelatedLinks=this.actions$.pipe(Object(yt.d)(r.LoadPrimaryIssueRelatedLinks),Object(It.a)((function(e){return n.jiraService.executeJql("key in (".concat(j.join(e.payload,","),")"),0,100,C.m,"linked-issues.json").pipe(Object(se.a)((function(e){return{type:r.LoadPrimaryIssueRelatedLinksSuccess,payload:e}})),Object(vt.a)((function(){return Object(Ct.a)({type:r.LoadPrimaryIssueRelatedLinksFailed})})))}))),this.loadSelectedIssue=this.actions$.pipe(Object(yt.d)(r.LoadSelectedIssue),Object(It.a)((function(e){return n.getIssueDetails(e.payload).pipe(Object(se.a)((function(e){return{type:r.LoadSelectedIssueSuccess,payload:e}})),Object(vt.a)((function(){return Object(Ct.a)({type:r.LoadSelectedIssueFailed})})))}))),this.loadSelectedIssueEpicChildren=this.actions$.pipe(Object(yt.d)(r.LoadSelectedIssueEpicChildren),Object(It.a)((function(e){return n.jiraService.executeJql("'epic Link'=".concat(e.payload," order by duedate"),0,100,C.m,"epic-children.json").pipe(Object(se.a)((function(e){return{type:r.LoadSelectedIssueEpicChildrenSuccess,payload:e}})),Object(vt.a)((function(){return Object(Ct.a)({type:r.LoadSelectedIssueEpicChildrenFailed})})))}))),this.loadSelectedIssueRelatedLinks=this.actions$.pipe(Object(yt.d)(r.LoadSelectedIssueRelatedLinks),Object(It.a)((function(e){return n.jiraService.executeJql("key in (".concat(j.join(e.payload,","),")  order by duedate"),0,100,C.m,"linked-issues.json").pipe(Object(se.a)((function(e){return{type:r.LoadSelectedIssueRelatedLinksSuccess,payload:e}})),Object(vt.a)((function(){return Object(Ct.a)({type:r.LoadSelectedIssueRelatedLinksFailed})})))}))),this.loadProjectConfig=this.actions$.pipe(Object(yt.d)(r.LoadProjectDetails),Object(It.a)((function(e){return n.jiraService.getProjectDetails(e.payload).pipe(Object(se.a)((function(e){var t=null;return e&&e.length>0&&((t=e[0]).customFields=j.sortBy(j.map(j.filter(e[1],{custom:!0}),(function(e){return j.pick(e,["id","name"])})),["name"])),{type:r.LoadProjectDetailsSuccess,payload:t}})),Object(vt.a)((function(){return Object(Ct.a)({type:r.LoadProjectDetailsFailed})})))}))),this.updateFieldValue=this.actions$.pipe(Object(yt.d)(r.UpdateFieldValue),Object(It.a)((function(e){return n.jiraService.updateFieldValue$(e.payload).pipe(Object(se.a)((function(){return{type:r.UpdateFieldValueSuccess,payload:e.payload}})),Object(vt.a)((function(){return Object(Ct.a)({type:r.UpdateFieldValueFailed})})))}))),this.updateOrganizationTitle=this.actions$.pipe(Object(yt.d)(r.UpdateOrganizationTitle),Object(kt.a)((function(e){return n.cachingService.setOrganization(e.payload)})),Object(It.a)((function(e){return Object(Ct.a)({type:r.UpdateOrganizationTitleSuccess,payload:e.payload})})))}return _createClass(e,[{key:"getIssueDetails",value:function(e){var t=this;return this.jiraService.getIssueDetails(e.issue,j.map(e.extendedFields,"id")).pipe(Object(se.a)((function(i){var s={issue:i,extendedFields:e.extendedFields,organization:t.cachingService.getOrganization(),projectConfig:null};return i&&i.fields&&i.fields.project&&i.fields.project.key&&i.fields.project.key.length>0&&(s.projectConfig=t.cachingService.getProjectDetails(i.fields.project.key)),s})))}}]),e}()).\u0275fac=function(e){return new(e||ht)(w.ec(yt.a),w.ec(Ot.b),w.ec(jt.a))},ht.\u0275prov=w.Mb({token:ht,factory:ht.\u0275fac}),Object(mt.b)([Object(yt.b)()],ht.prototype,"loadPrimaryIssue",void 0),Object(mt.b)([Object(yt.b)()],ht.prototype,"loadPrimaryIssueEpicChildren",void 0),Object(mt.b)([Object(yt.b)()],ht.prototype,"loadPrimaryIssueRelatedLinks",void 0),Object(mt.b)([Object(yt.b)()],ht.prototype,"loadSelectedIssue",void 0),Object(mt.b)([Object(yt.b)()],ht.prototype,"loadSelectedIssueEpicChildren",void 0),Object(mt.b)([Object(yt.b)()],ht.prototype,"loadSelectedIssueRelatedLinks",void 0),Object(mt.b)([Object(yt.b)()],ht.prototype,"loadProjectConfig",void 0),Object(mt.b)([Object(yt.b)()],ht.prototype,"updateFieldValue",void 0),Object(mt.b)([Object(yt.b)()],ht.prototype,"updateOrganizationTitle",void 0),ht),St=i("AytR"),Vt=i("SYT+"),wt=i("LvOF"),Wt=i("jhN1"),Pt=((ft=function(){function e(t,i,s,n){_classCallCheck(this,e),this.router=t,this.activatedRoute=i,this.titleService=s,this.store$=n,this.extendedFields=[],this.leftPaneSize=20,this.columns=[{visible:!0,size:20},{visible:!0,size:80}]}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.reloadOnChange(),this.store$.select((function(e){return e.app.organization})).pipe(Object(P.a)((function(e){return e}))).subscribe((function(t){return e.store$.dispatch(new v(t))}));var t=this.activatedRoute.params.pipe(Object(P.a)((function(e){return e&&e.issue&&e.issue.length>0})),Object(se.a)((function(e){return e.issue}))),i=this.store$.select((function(e){return e.app.projects}));this.combined$=Object(W.a)(t,i).subscribe((function(t){var i=_slicedToArray(t,2),s=i[0],n=i[1];e.titleService.setTitle("".concat(St.a.appTitle,": ").concat(s)),e.extendedFields=n?Object(wt.c)(n):[],e.store$.dispatch(new o({issue:s,extendedFields:e.extendedFields}))})),this.primaryIssue$=this.store$.select((function(e){return e.issue.primaryIssue})).pipe(Object(P.a)((function(e){return e}))).subscribe((function(t){e.primaryIssue=t,e.populateProjectConfig(),e.populateEpicChildren(),e.populateRelatedLinks(),e.buildTree()}))}},{key:"reloadOnChange",value:function(){var e=this;this.currentProject$=this.store$.select((function(e){return e.app.currentProject})).pipe(Object(P.a)((function(){return e.primaryIssue}))).subscribe((function(t){if(e.primaryIssue&&t){var i=j.find(t.standardIssueTypes,{name:e.primaryIssue.issueType});if(i){var s=j.union(i.list,j.filter(t.customFields,{name:"Epic Link"}));t.startdate&&s.push(t.startdate);var n=[];s.forEach((function(t){!j.find(e.extendedFields,{id:t.id})&&n.push(t)})),n.length>0&&(e.extendedFields=j.clone(s),e.store$.dispatch(new o({issue:e.primaryIssue.key,extendedFields:e.extendedFields})))}}})),this.updatedField$=this.store$.select((function(e){return e.issue.updatedField})).pipe(Object(P.a)((function(t){return t&&e.primaryIssue}))).subscribe((function(t){e.store$.dispatch(new o({issue:e.primaryIssue.key,extendedFields:e.extendedFields}))}))}},{key:"ngOnDestroy",value:function(){this.currentProject$&&this.currentProject$.unsubscribe(),this.updatedField$&&this.updatedField$.unsubscribe(),this.combined$&&this.combined$.unsubscribe(),this.primaryIssue$&&this.primaryIssue$.unsubscribe()}},{key:"buildTree",value:function(){if(!0===this.primaryIssue.epicChildrenLoaded&&!0===this.primaryIssue.relatedLinksLoaded&&!0===this.primaryIssue.projectConfigLoaded){var e=Object(C.k)(this.primaryIssue.organization),t=Object(C.l)(this.primaryIssue.projectConfig),i=this.primaryIssue.projectConfig.hierarchy?this.prepareHierarchyNodes():null;t=Object(C.c)(e,t),i=Object(C.c)(t,i),this.primaryIssue.expanded=!0,this.rootNode=Object(C.c)(i,this.primaryIssue),this.store$.dispatch(new d(this.rootNode))}}},{key:"prepareHierarchyNodes",value:function(){var e=this,t={children:[]};if(this.primaryIssue.projectConfig.hierarchy.forEach((function(i){var s=j.find(e.primaryIssue.extendedFields,{id:i.id});s&&s.extendedValue&&s.extendedValue.length>0&&t.children.push(Object(C.j)(s))})),t.children.length>0){var i=t.children[0];return Object(C.g)(t.children,i),i}return null}},{key:"populateEpicChildren",value:function(){this.primaryIssue.issueType===C.a.Epic?this.primaryIssue.epicChildrenLoaded?!j.find(this.primaryIssue.children,{issueType:C.a.EpicChildren})&&this.primaryIssue.epicChildren&&this.primaryIssue.epicChildren.length>0&&(this.primaryIssue.children=this.primaryIssue.children||[],this.primaryIssue.children.unshift(Object(C.i)(this.primaryIssue)),this.primaryIssue.expanded=!0):this.primaryIssue.epicChildrenLoading||this.store$.dispatch(new l(this.primaryIssue.key)):this.primaryIssue.epicChildrenLoaded=!0}},{key:"populateRelatedLinks",value:function(){var e=this;if(this.primaryIssue&&this.primaryIssue.relatedLinks&&this.primaryIssue.relatedLinks.length>0)if(this.primaryIssue.relatedLinksLoaded){if(0===j.filter(this.primaryIssue.children,{issueType:C.a.RelatedLink}).length){var t=Object(C.f)(this.primaryIssue.relatedLinks,this.primaryIssue.key);t&&(this.primaryIssue.children=this.primaryIssue.children||[],t.forEach((function(t){return e.primaryIssue.children.push(t)})))}}else!this.primaryIssue.relatedLinksLoading&&this.primaryIssue.relatedLinks&&this.primaryIssue.relatedLinks.length>0&&this.store$.dispatch(new u(j.map(this.primaryIssue.relatedLinks,"key")));else this.primaryIssue.relatedLinksLoaded=!0}},{key:"populateProjectConfig",value:function(){this.primaryIssue.projectConfigLoaded?this.primaryIssue.projectConfig&&this.store$.dispatch(new Vt.n(this.primaryIssue.projectConfig)):this.primaryIssue.project&&this.primaryIssue.project.key&&this.primaryIssue.project.key.length>0&&!this.primaryIssue.projectConfigLoading&&this.store$.dispatch(new b(this.primaryIssue.project.key))}},{key:"nodeContextMenuSelect",value:function(e){console.log(e)}},{key:"dragEnd",value:function(e){this.adjustPaneSize(e.sizes[0])}},{key:"adjustPaneSize",value:function(e){this.leftPaneSize=e,this.columns[0].size=e,this.columns[1].size=100-e}},{key:"toggleFullscreen",value:function(){this.adjustPaneSize(0===this.leftPaneSize?20:0)}}]),e}()).\u0275fac=function(e){return new(e||ft)(w.Qb(q.d),w.Qb(q.a),w.Qb(Wt.c),w.Qb(n.h))},ft.\u0275cmp=w.Kb({type:ft,selectors:[["app-primary-issue-container"]],decls:2,vars:0,consts:[[1,"main-container"]],template:function(e,t){1&e&&(w.Wb(0,"div",0),w.Rb(1,"router-outlet"),w.Vb())},directives:[q.h],encapsulation:2}),ft),Ft=i("yNBN"),Rt=i("L6qz");function qt(e,t){if(1&e){var i=w.Xb();w.Wb(0,"div"),w.Wb(1,"div",6),w.Rb(2,"fa-icon",7),w.Oc(3," Connection details are incomplete. "),w.Vb(),w.Wb(4,"a",8),w.ic("click",(function(){return w.Fc(i),w.kc(2).onShowSetup()})),w.Oc(5," Enter credentials "),w.Rb(6,"fa-icon",9),w.Vb(),w.Vb()}}var xt=function(){return["fab","jira"]},zt=function(){return{mode:"import"}};function Et(e,t){if(1&e){var i=w.Xb();w.Wb(0,"div"),w.Wb(1,"div",10),w.Rb(2,"fa-icon",11),w.Oc(3," Please provide Jira connection details "),w.Vb(),w.Wb(4,"a",12),w.ic("click",(function(){return w.Fc(i),w.kc(2).onShowSetup()})),w.Oc(5," Manual setup "),w.Rb(6,"fa-icon",13),w.Vb(),w.Wb(7,"a",14),w.Rb(8,"fa-icon",15),w.Oc(9," Import config file "),w.Vb(),w.Vb()}2&e&&(w.Cb(2),w.qc("icon",w.tc(2,xt)),w.Cb(5),w.qc("queryParams",w.tc(3,zt)))}function $t(e,t){if(1&e&&(w.Wb(0,"div",2),w.Wb(1,"div",3),w.Mc(2,qt,7,0,"div",1),w.Mc(3,Et,10,4,"div",1),w.Vb(),w.Wb(4,"div",4),w.Wb(5,"ol"),w.Wb(6,"li"),w.Oc(7,"Setup the jira connection details"),w.Vb(),w.Wb(8,"li"),w.Oc(9,"Enter the Jira issue key"),w.Vb(),w.Wb(10,"li"),w.Oc(11,"Track purpose of issue"),w.Vb(),w.Vb(),w.Rb(12,"app-help-link",5),w.Vb(),w.Vb()),2&e){var i=w.kc();w.Cb(2),w.qc("ngIf",i.connectionDetails&&i.connectionDetails.serverUrl&&!i.connectionDetails.verified),w.Cb(1),w.qc("ngIf",!i.connectionDetails||!i.connectionDetails.serverUrl)}}function Tt(e,t){1&e&&(w.Wb(0,"div"),w.Rb(1,"router-outlet"),w.Vb())}var Mt,_t=((Mt=function(){function e(t,i){_classCallCheck(this,e),this.messageService=t,this.store$=i,this.isOnlineMode=!1}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.store$.select((function(e){return e.app.mode})).subscribe((function(t){return e.isOnlineMode=t&&t===Vt.e.Online})),this.connectionDetailsSubscription=this.store$.select((function(e){return e.app.connectionDetails})).subscribe((function(t){return e.connectionDetails=t}))}},{key:"ngOnDestroy",value:function(){this.connectionDetailsSubscription&&this.connectionDetailsSubscription.unsubscribe()}},{key:"onShowSetup",value:function(){this.store$.dispatch(new Vt.k(!0))}}]),e}()).\u0275fac=function(e){return new(e||Mt)(w.Qb(z.c),w.Qb(n.h))},Mt.\u0275cmp=w.Kb({type:Mt,selectors:[["app-issue-home"]],decls:2,vars:2,consts:[["class","center-text custom-shadow p-3 bg-light",4,"ngIf"],[4,"ngIf"],[1,"center-text","custom-shadow","p-3","bg-light"],[1,"alert","bg-white"],[1,"text-left"],["tag","setup",1,"float-right"],[1,"mb-2"],["icon","exclamation-triangle",1,"text-warning"],[1,"btn","btn-sm","btn-primary","text-white","mt-2",3,"click"],["icon","chevron-right"],[1,"mb-3","alert-warning","p-2","rounded"],[1,"text-primary",3,"icon"],[1,"btn","btn-primary","btn-sm","text-white","mr-2",3,"click"],["icon","angle-right"],["routerLink","../configurations",1,"btn","btn-light","border","btn-sm",3,"queryParams"],["icon","file-import",1,"text-muted"]],template:function(e,t){1&e&&(w.Mc(0,$t,13,2,"div",0),w.Mc(1,Tt,2,0,"div",1)),2&e&&(w.qc("ngIf",!(t.connectionDetails&&t.connectionDetails.verified)&&t.isOnlineMode),w.Cb(1),w.qc("ngIf",t.connectionDetails&&t.connectionDetails.verified||!1===t.isOnlineMode))},directives:[s.n,Rt.a,R.a,q.f,q.h],encapsulation:2}),Mt),Nt=i("sfS8");function Dt(e,t){1&e&&(w.Wb(0,"div",13),w.Oc(1," StoryPurpose is a set of visualization tools for agile teams that help ensure every story's purpose aligns with that of the organization "),w.Wb(2,"div",14),w.Wb(3,"a",15),w.Oc(4,"Learn more... "),w.Rb(5,"fa-icon",16),w.Vb(),w.Vb(),w.Vb())}function Ut(e,t){if(1&e){var i=w.Xb();w.Oc(0," Proceed by entering Jira issue key "),w.Wb(1,"div",17),w.Wb(2,"input",18),w.ic("ngModelChange",(function(e){return w.Fc(i),w.kc().key=e}))("keydown.enter",(function(){w.Fc(i);var e=w.kc();return e.navigateToKey(e.key)}))("keydown.escape",(function(){return w.Fc(i),w.kc().key=""})),w.Vb(),w.Wb(3,"div",19),w.Wb(4,"button",20),w.ic("click",(function(){w.Fc(i);var e=w.kc();return e.navigateToKey(e.key)})),w.Rb(5,"fa-icon",21),w.Vb(),w.Vb(),w.Vb(),w.Wb(6,"div",22),w.Wb(7,"ul",23),w.Wb(8,"li"),w.Wb(9,"b"),w.Oc(10,"EpicPurpose: "),w.Vb(),w.Oc(11," Useful for visualizing all EPIC issues and how they span across various components/modules within the application. "),w.Vb(),w.Wb(12,"li",24),w.Wb(13,"b"),w.Oc(14,"StoryPurpose: "),w.Vb(),w.Oc(15," Useful for visualizing a selected story in the context of other linked issues, highlighting dependencies and overall associated feature delivery pipeline. "),w.Vb(),w.Vb(),w.Vb()}if(2&e){var s=w.kc();w.Cb(2),w.qc("ngModel",s.key)("appAutofocus",1===s.selectedTab),w.Cb(2),w.qc("disabled",!s.canNavigateToKey()),w.Cb(1),w.qc("fixedWidth",!0)}}function At(e,t){if(1&e){var i=w.Xb();w.Oc(0," Proceed by entering Jira query (JQL) "),w.Wb(1,"div",17),w.Wb(2,"input",25),w.ic("ngModelChange",(function(e){return w.Fc(i),w.kc().query=e}))("keydown.enter",(function(){w.Fc(i);var e=w.kc();return e.navigateJql(e.query)}))("keydown.escape",(function(){return w.Fc(i),w.kc().query=""})),w.Vb(),w.Wb(3,"div",19),w.Wb(4,"button",20),w.ic("click",(function(){w.Fc(i);var e=w.kc();return e.navigateJql(e.query)})),w.Rb(5,"fa-icon",26),w.Vb(),w.Vb(),w.Vb(),w.Wb(6,"div",22),w.Wb(7,"ul",23),w.Wb(8,"li"),w.Wb(9,"b"),w.Oc(10,"Storyboard and timeline for related issues: "),w.Vb(),w.Oc(11," This provides flexibility to choose multiple relevant issues and view on a story map. "),w.Vb(),w.Vb(),w.Vb()}if(2&e){var s=w.kc();w.Cb(2),w.qc("ngModel",s.query)("appAutofocus",2===s.selectedTab),w.Cb(2),w.qc("disabled",!s.canNavigateJql()),w.Cb(1),w.qc("fixedWidth",!0)}}var Kt,Qt,Ht=function(){return["far","question-circle"]},Xt=((Qt=function e(t){var i=this;_classCallCheck(this,e),this.router=t,this.selectedTab=1,this.showSingleIssueHelp=!1,this.showJQLHelp=!1,this.showStoryPurposeHelp=!1,this.key="",this.query="",this.navigateToKey=function(e){return i.router.navigate(["/browse",e.trim()])},this.canNavigateToKey=function(){return i.key&&i.key.trim().length>0},this.navigateJql=function(e){return i.router.navigate(["/search/list"],{queryParams:{query:e}})},this.canNavigateJql=function(){return i.query&&i.query.trim().length>0}}).\u0275fac=function(e){return new(e||Qt)(w.Qb(q.d))},Qt.\u0275cmp=w.Kb({type:Qt,selectors:[["app-issue-not-entered"]],decls:19,vars:8,consts:[[1,"center-text"],[1,"mb-3","font-weight-light"],["src","/assets/logo.png","height","32pt",1,"mr-1"],[1,"btn","btn-sm","btn-link","text-muted",3,"click"],[3,"icon"],["class","p-3 mb-3 bg-light text-left",4,"ngIf"],[1,"text-left","mt-5"],["ngbNav","",1,"nav-tabs",3,"activeId","destroyOnHide","activeIdChange"],["nav","ngbNav"],[3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],[1,"p-3","bg-light","border-left","border-bottom","border-right",3,"ngbNavOutlet"],[1,"p-3","mb-3","bg-light","text-left"],[1,"text-right"],["href","https://www.storypurpose.info","target","_blank",1,"small"],["icon","external-link-alt","size","sm"],[1,"input-group","mt-2"],["type","text","name","key","placeholder","Epic or Story key",1,"form-control",3,"ngModel","appAutofocus","ngModelChange","keydown.enter","keydown.escape"],[1,"input-group-append"],["type","button",1,"btn","btn-primary","border","border-left-0",3,"disabled","click"],["icon","chevron-right",3,"fixedWidth"],[1,"p-3","text-muted","mt-2"],[1,"small","pl-2","mb-0"],[1,"mt-3"],["type","text","name","query","placeholder","JQL",1,"form-control",3,"ngModel","appAutofocus","ngModelChange","keydown.enter","keydown.escape"],["icon","search",3,"fixedWidth"]],template:function(e,t){if(1&e&&(w.Wb(0,"div",0),w.Wb(1,"h4",1),w.Rb(2,"img",2),w.Oc(3," StoryPurpose for Jira "),w.Wb(4,"button",3),w.ic("click",(function(){return t.showStoryPurposeHelp=!t.showStoryPurposeHelp})),w.Rb(5,"fa-icon",4),w.Vb(),w.Vb(),w.Mc(6,Dt,6,0,"div",5),w.Wb(7,"div",6),w.Wb(8,"ul",7,8),w.ic("activeIdChange",(function(e){return t.selectedTab=e})),w.Wb(10,"li",9),w.Wb(11,"a",10),w.Oc(12,"Epic/Story"),w.Vb(),w.Mc(13,Ut,16,4,"ng-template",11),w.Vb(),w.Wb(14,"li",9),w.Wb(15,"a",10),w.Oc(16,"Jira query"),w.Vb(),w.Mc(17,At,12,4,"ng-template",11),w.Vb(),w.Vb(),w.Rb(18,"div",12),w.Vb(),w.Vb()),2&e){var i=w.Dc(9);w.Cb(5),w.qc("icon",w.tc(7,Ht)),w.Cb(1),w.qc("ngIf",t.showStoryPurposeHelp),w.Cb(2),w.qc("activeId",t.selectedTab)("destroyOnHide",!1),w.Cb(2),w.qc("ngbNavItem",1),w.Cb(4),w.qc("ngbNavItem",2),w.Cb(4),w.qc("ngbNavOutlet",i)}},directives:[R.a,s.n,Le.j,Le.l,Le.m,Le.k,Le.o,te.b,te.f,te.i,Nt.a],encapsulation:2}),Qt),Bt=((Kt=function(){function e(t,i){var s=this;_classCallCheck(this,e),this.router=t,this.activatedRoute=i,this.router.events.subscribe((function(e){e instanceof q.b&&s.autoRedirect()}))}return _createClass(e,[{key:"ngOnInit",value:function(){this.autoRedirect()}},{key:"autoRedirect",value:function(){0===this.activatedRoute.children.length&&this.router.navigate([this.activatedRoute.parent.snapshot.params.issue],{relativeTo:this.activatedRoute})}}]),e}()).\u0275fac=function(e){return new(e||Kt)(w.Qb(q.d),w.Qb(q.a))},Kt.\u0275cmp=w.Kb({type:Kt,selectors:[["app-selected-issue-home"]],decls:1,vars:0,template:function(e,t){1&e&&w.Rb(0,"router-outlet")},directives:[q.h],encapsulation:2}),Kt),Jt=i("5fYs");function Gt(e,t){if(1&e&&w.Rb(0,"app-timeline-renderer",3),2&e){var i=w.kc();w.qc("timeline",i.timeline)("contentHeight",i.contentHeight)}}var Yt,Zt=((Yt=function(e){function t(e,i){var s;return _classCallCheck(this,t),(s=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,i))).cdRef=e,s.store$=i,s}return _inherits(t,e),_createClass(t,[{key:"ngOnInit",value:function(){var e=this;this.init(81),this.selectedIssue$=this.store$.select((function(e){return e.issue.selectedIssue})).pipe(Object(P.a)((function(e){return e}))).subscribe((function(t){t.projectConfig&&t.projectConfig.startdate&&!j.find(C.w,t.projectConfig.startdate.id)&&C.w.push(t.projectConfig.startdate.id),e.selectedIssue=j.pick(t,j.union(C.w,["children"])),e.store$.dispatch(new m(e.selectedIssue.children))})),this.timeline$=this.store$.select((function(e){return e.issue.timelineView})).pipe(Object(P.a)((function(e){return e}))).subscribe((function(t){return e.timeline=t}))}},{key:"ngOnDestroy",value:function(){this.destroy(),this.selectedIssue$&&this.selectedIssue$.unsubscribe(),this.timeline$&&this.timeline$.unsubscribe()}},{key:"ngAfterViewInit",value:function(){this.afterViewInit()}}]),t}(ce)).\u0275fac=function(e){return new(e||Yt)(w.Qb(w.h),w.Qb(n.h))},Yt.\u0275cmp=w.Kb({type:Yt,selectors:[["app-timeline"]],features:[w.zb],decls:3,vars:1,consts:[[1,"selectedIssue"],["content",""],[3,"timeline","contentHeight",4,"ngIf"],[3,"timeline","contentHeight"]],template:function(e,t){1&e&&(w.Wb(0,"div",0,1),w.Mc(2,Gt,1,2,"app-timeline-renderer",2),w.Vb()),2&e&&(w.Cb(2),w.qc("ngIf",t.timeline))},directives:[s.n,Jt.a],encapsulation:2}),Yt),ei=i("EVgl"),ti=i("0kVS"),ii=i("nRR4");i.d(t,"IssueModule",(function(){return ci}));var si,ni=[{path:"",component:_t,children:[{path:":issue",component:Pt,children:[{path:"purpose",component:Bt,children:[{path:":selected",component:je,children:[{path:"details",component:Z},{path:"workbench",component:Xe},{path:"storyboard",component:gt},{path:"timeline",component:Zt},{path:"",redirectTo:"details",pathMatch:"full"}]}]},{path:"",redirectTo:"purpose",pathMatch:"full"}]},{path:"",component:Xt}]}],ci=((si=function e(){_classCallCheck(this,e)}).\u0275mod=w.Ob({type:si}),si.\u0275inj=w.Nb({factory:function(e){return new(e||si)},imports:[[s.c,q.g,te.c,ti.a,ii.a,K.b,x.b,ei.c,Ft.a,Ye.b,ie.b,Ge.b,Le.g,Le.c,Le.n,Le.t,R.c,F.a,ee.a,n.j.forFeature("issue",L,{initialState:c}),yt.c.forFeature([Lt]),q.g.forChild(ni)]]}),si)}}]);